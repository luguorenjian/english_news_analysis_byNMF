# english_news_analysis_byNMF

## 目的
大量の英文記事から隠れたパタンを抽出し、似てる記事をクラスタリングする

## 原理
世の中のデータは成分が非負値で表されるものが多い. 例えば：
+ 各ドキュメントが各単語をいくつ含んでいるかのデータ
+ 各ユーザが各商品をいくつ購入したかのデータ

例： 

|  |商品A|商品B|商品C|商品D|商品E|
|--|:--:|:---:|:--:|:--:|---:|
|ユーザ１|１|１|２|１|３|
|ユーザ２|２|３|３|４|４|
|ユーザ３|１|１|２|１|３|
|ユーザ４|１|２|１|３|１|

このデータを非負値行列 X としてあらわす、非負値行列の積 U * V で分解
<img src="https://github.com/luguorenjian/english_news_analysis_byNMF/blob/master/nmf.png" width=600 height=200 />

これで解釈がしやすい! 
+ 各ユーザの購買ベクトル(行ベクトル)は、２つの購買パターンu1=(1,1,2,1,3)とu2=(1,2,1,3,1)の線形和　
+ ユーザ１,2,3,4の購買ベクトルはそれぞれu1,u2方向の成分が(1,0),(1,1),(1,0),(0,1)のベクトル 

このように一つの非負値行列を二つの非負値行列の積で分解する方法をNMF(Nonnegative Matrix Factorization)と呼ぶ。実は、一般の非負値行列 X に対して、U と V を求めるのは数学的にNP問題であることが知られている。ここで中村先生(機械学習とパタン認識という授業を担当する先生)から助けをもらって、近似解を求める方法が開発されていることがわかった。具体的な方法はこちら： 

<img src="https://github.com/luguorenjian/english_news_analysis_byNMF/blob/master/nmf更新ルール.png" width=500 height=450 /><\n>
このアルゴリズムを実装したファイルはこちら：

## 実施内容
1. 英文ニュースRSSサイトから記事を取り出す。feedparserというpythonのライブラリを使って、記事をとる。具体的な手順はこちら：
<a href="https://github.com/luguorenjian/english_news_analysis_byNMF/blob/master/getnewsrss.py" target="_blank">getnewsrss.py</a> 取り出された記事はこちら：<a href="https://github.com/luguorenjian/english_news_analysis_byNMF/blob/master/news.txt" target="_blank">news.txt</a>
2. 取られた記事を行列に入れる。入れる前に前処理が必要である。なぜなら、英語は日本語のような活用形がある。例えば、sleep,sleeps,sleepingは一緒の意味を持っている。もしこれらを違う意味を持つ単語として行列に入れれば、行列の大きさはすごく大きくなり、行列分解の効率が低い。なので、ここではporter2 stemming algorithmを使って、英単語の語幹だけを取り出す。またはひとつの記事に二回以上出ている単語だけを行列に入れること。これも行列の大きさをコントロール方法の一つです。最終的に得られた行列はこういう感じである、中の数字はそれぞれの単語の出現頻度である：

|  |単語１|単語２|単語３|単語４|...|
|--|:--:|:---:|:--:|:--:|---:|
|記事１|１|１|２|１|...|
|記事２|２|３|３|４|...|
|記事３|１|１|２|１|...|
|...|...|...|...|...|...|
3. 実装したnmf.pyを使って、行列分解する
4. 結果を図表であらわす、抽出されたパタンをここではトピックと呼ぶ：

|  | | | | |...|
|--|:--:|:---:|:--:|:--:|---:|
|トピック１|１|１|２|１|...|
|トピック２|１|１|２|１|...|
|トピック３|１|１|２|１|...|
|トピック４|１|１|２|１|...|
|トピック５|１|１|２|１|...|
|トピック６|１|１|２|１|...|
|トピック７|１|１|２|１|...|
|トピック８|１|１|２|１|...|
|トピック９|１|１|２|１|...|
|トピック１０|１|１|２|１|...|








